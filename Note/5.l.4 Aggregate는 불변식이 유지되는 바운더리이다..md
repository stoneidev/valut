
[[5.l.4.a Aggregate와 연관 관계|Aggregate는 연관관계를 고려해야 한다.]]
Aggregate를 만들 때에는 아래의 [[5.l.4.b Aggregate 구현의 규칙|규칙]]을 고려하라.

==Aggregate는 생명주기의 전 단계에서 불변식이 유지돼야 할 범위를 표시해준다.== 이어지는 패턴인 Factory와 Repository는 Aggregate를 대상으로 연산을 수행하며, 특정 생명 주기 전이에 따르는 복잡성을 캡슐화한다. 

Entity와 Value Object를 Aggregate로 모으고 각각에 대해 경계를 정의하라. 한 Entity를 골라 Aggregate의 루트로 만들고 Aggregate 경계 내부의 객체에 대해서는 루트를 거쳐 접근할 수 있게 하라. Aggregate 밖의 객체는 루트만 참조할 수 있게 하라. 내부 구성요소에 대한 일시적인 참조는 단일 연산에서만 사용할 목적에 한해 외부로 전달될 수 있다. 루트는 경유하지 않고는 Aggregate의 내부를 변경할 수 없다. 이런 식으로 Aggregate의 각 요소를 배치하면 Aggregate 안의 객체와 전체로서의 Aggregate의 상태를 변경할 때 모든 불변식을 효과적으로 이행할 수 있다.

Aggregate는 우리가 데이터 변경의 단위로 다루는 연관 객체의 묶음을 말한다. 각 Aggregate에는 루트와 경계가 있다. 경계는 Aggregate에 무엇이 포함되고 포함되지 않는지를 정의한다. 루트는 단 하나만 존재하며, Aggregate에 포함된 특정 Entity를 가리킨다. 경계 안의 객체는 서로 참조할 수 있지만, 경계 바깥의 객체는 Aggregate의 구성요소 가운데 루트만 참조할 수 있다. 루트 이외의 entity는 지역 식별성을 지니며, 지역 식별성은 aggregate 내에서만 구분되면 된다. 이는 해당 Aggregate의 경계 밖에 위치한 객치는 루트 entity의 컨텍스트 말고는 aggregate의 내부를 볼 수 없기 때문이다.

Referenced By : [[도메인 주도 설계]]